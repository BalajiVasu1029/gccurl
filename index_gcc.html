<!DOCTYPE html>
<html>
<head>
<title>Open NissanConnect App</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<p>Redirecting ...</p>
 
  <script>
    window.onload = function () {
      // Custom URL scheme
      var deepLinkAndroid = 'mynissangcc://open';
      var deepLinkiOS = 'mynissangcc://';
 
      // Fallback URLs
      var fallbackAndroid = 'https://play.google.com/store/apps/details?id=eu.gom.services'; // replace with your package name
      var fallbackiOS = 'https://apps.apple.com/sa/app/mynissan/id1605694217'; // replace with your actual App Store ID
 
      // Detect platform
      var userAgent = navigator.userAgent || navigator.vendor || window.opera;
      var isIOS = /iPhone|iPad|iPod/i.test(userAgent);
      var isAndroid = /Android/i.test(userAgent);
 
      // Set fallback
      var fallbackUrl = isIOS ? fallbackiOS : fallbackAndroid;
 
      // Track time to measure whether app opened
      var clickedAt = Date.now();
 
      // Fallback timeout
      var timer = setTimeout(function () {
        // If app didn't open within 1.5s, redirect to store
        if (Date.now() - clickedAt < 2000) {
          window.location.href = fallbackUrl;
        }
      }, 1500);
 
      // If user leaves the page (app opened), cancel redirect
      document.addEventListener('visibilitychange', function () {
        if (document.visibilityState === 'hidden') {
          clearTimeout(timer);
        }
      });
 
      // Try to open the app
      window.location.href = isIOS?deepLinkiOS:deepLinkAndroid;
    };
</script>
</body>
</html>
